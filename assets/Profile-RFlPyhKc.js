import{r as t,_ as S,b as F,j as e,T as M,c as k,h as w,d as v,e as R,S as O,f as J,J as G,P as H,i as z,t as q,k as g,s as P,l as K,m as V,n as W,E as Y,o as Z,p as $,q as Q,C as j,B as X,v as ee}from"./index-C7dcxcLS.js";import{B as E,C as x}from"./Button-CA8pjaeo.js";import{L as ae}from"./List-DeDa1ahv.js";import{_ as se,a as te,S as N}from"./Section-Dr49_n6q.js";import{A as le}from"./Avatar-0IvsBy93.js";import{I as re}from"./Input-B6LaYHds.js";const ne=t.forwardRef((r,n)=>{var{mode:d="default",before:l,after:o,className:i,children:u,Component:m}=r,C=S(r,["mode","before","after","className","children","Component"]);const s=F(),h=s==="ios"?O:J;return e.jsxs(M,k(v({ref:n,Component:m||"button",className:R("tgui-a8ce18a8594cea9b",d==="destructive"&&"tgui-6e7ca796043fe6ca",s==="ios"&&"tgui-f464dba82cb8b46e",i)},C),{children:[w(l)&&l,w(u)&&e.jsx(h,{children:u}),w(o)&&o]}))}),oe=t.forwardRef((r,n)=>{var{Component:d="span",className:l}=r,o=S(r,["Component","className"]);return e.jsx(d,k(v({},o),{ref:n,className:R("tgui-b9fd8cdf929947df",l)}))}),ie=r=>{var n=se({},te(r));return e.jsx("svg",k(v({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),{children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.286 6.445c-2.342-2.307-6.19-2.307-8.53 0l-5.353 5.272a.99.99 0 0 1-1.388-1.41l5.352-5.272c3.112-3.065 8.196-3.065 11.307 0a7.598 7.598 0 0 1 0 10.885l-7.347 7.238c-2.355 2.32-6.198 2.32-8.553 0a5.762 5.762 0 0 1 0-8.253l7.381-7.27c1.585-1.56 4.141-1.632 5.814-.167a4.06 4.06 0 0 1 .082 6.068l-6.158 5.688a.99.99 0 0 1-1.343-1.454l6.16-5.687c.93-.859.91-2.29-.044-3.127a2.315 2.315 0 0 0-3.122.088l-7.381 7.27a3.784 3.784 0 0 0 0 5.435c1.584 1.56 4.191 1.56 5.775 0l7.348-7.238a5.62 5.62 0 0 0 0-8.066Z",fill:"currentColor"})}))},ce=t.forwardRef((r,n)=>{var{label:d="Attach file",className:l,children:o}=r,i=S(r,["label","className","children"]);return e.jsxs("div",{ref:n,className:l,children:[o,e.jsxs(ne,{Component:"label",before:e.jsx(ie,{}),children:[e.jsx(oe,{children:e.jsx("input",v({type:"file",placeholder:d},i))}),d]})]})}),de=""+new URL("avatar_placeholder_black-DRyce69K.png",import.meta.url).href,me=""+new URL("avatar_placeholder_white-CbxutB7M.png",import.meta.url).href,y=[{sector:"personal",name:"photoUrl",displayName:"Avatar",editable:!0},{sector:"personal",name:"username",displayName:"Username",editable:!0},{sector:"personal",name:"email",displayName:"Email",editable:!0},{sector:"personal",name:"fullName",displayName:"Full name",editable:!0},{sector:"system",name:"id",displayName:"Inner ID",editable:!1},{sector:"system",name:"tg_id",displayName:"Telegram ID",editable:!1},{sector:"others",name:"languageCode",displayName:"Locale",editable:!1},{sector:"others",name:"role",displayName:"User Role",editable:!1}],he=[{sector:"geolocation",name:"available",displayName:"Geoposition enabled",editable:!1},{sector:"geolocation",name:"latitude",displayName:"Latitude",editable:!1},{sector:"geolocation",name:"longitude",displayName:"Longitude",editable:!1},{sector:"geolocation",name:"formattedAdress",displayName:"FormattedAddress",editable:!1},{sector:"geolocation",name:"country",displayName:"Country name",editable:!1},{sector:"geolocation",name:"city",displayName:"City name",editable:!1},{sector:"geolocation",name:"street",displayName:"Street name",editable:!1},{sector:"geolocation",name:"house",displayName:"House No",editable:!1}],je=()=>{if(!G())return e.jsx(H,{header:"Oops",description:"Application was launched with missing init data",children:e.jsx("img",{alt:"Telegram sticker",src:"https://xelene.me/telegram.gif",style:{display:"block",width:"144px",height:"144px"}})});const n=z(),d=q(),[l,o]=t.useState(g(P)),[i,u]=t.useState(g(P)),m=g(K),C=g(V),[s,h]=t.useState(i?C:m),f=g(W),[A,D]=t.useState({available:f.available,...f.location,...f.address});t.useEffect(()=>{D({available:f.available,...f.location,...f.address})},[f]);const[U,_]=t.useState([]);if(!s)return e.jsx(Y,{children:"Something went wrong with user"});t.useEffect(()=>{n(Z(i))},[i]),t.useEffect(()=>{JSON.stringify(m)!==JSON.stringify(s)?(n($(s)),_(y.map(a=>s[a.name]!==m[a.name]?a.name:"")),u(!0)):(u(!1),_([]))},[s]),t.useEffect(()=>{i||(console.log("Sync user"),h(m))},[m]);const I=a=>{a.preventDefault(),console.log("Edit mode handler"),o(!0),l&&!i&&o(!1)},T=a=>{a.preventDefault(),console.log("Avatar change");const c=a.currentTarget.files;c&&h({...s,photoUrl:URL.createObjectURL(c[0])})},L=a=>{a.preventDefault(),console.log("Changes saved"),n(ee(s)),o(!1),u(!1)},B=a=>{a.preventDefault(),console.log("Changes canceled"),h(m),o(!1),u(!1)},[p,b]=t.useState(!1);return e.jsxs("div",{className:"md:container md:mx-auto pt-2",children:[i&&e.jsx("div",{className:"bg-yellow-400 text-center rounded-lg mb-1",children:"You have uncommited changes!!!"}),e.jsxs("div",{className:"p-2 flex align-middle items-center justify-between w-full",children:[e.jsx(Q,{children:"My profile"}),e.jsx(E,{mode:"plain",onClick:I,children:"Edit"})]}),e.jsxs(ae,{className:"flex flex-col h-full gap-8",children:[e.jsx(N,{header:"Personal Info",children:y.filter(a=>a.sector==="personal").map(a=>e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),a.name==="photoUrl"&&e.jsxs(x,{after:a.editable&&l&&e.jsx(ce,{id:"input_file",onChange:T,accept:"image/png, image/jpeg"}),children:[U.includes(a.name)&&e.jsx(X,{type:"number",mode:"critical",large:!0,className:"absolute left-2 top-2 z-10",children:"Edited"}),e.jsx(le,{size:96,src:s.photoUrl?s.photoUrl:d.isDark?me:de})]}),a.name!=="photoUrl"&&e.jsx(e.Fragment,{children:l&&a.editable?e.jsx(re,{readOnly:!(l&&a.editable),status:U.includes(a.name)?"error":"default",inputMode:"text",placeholder:a.displayName,value:s[a.name],onChange:c=>{switch(a.name){case"username":h({...s,username:c.currentTarget.value});break;case"email":h({...s,email:c.currentTarget.value});break;case"fullName":h({...s,fullName:c.currentTarget.value});break}}}):e.jsx(x,{multiline:p,onClick:()=>b(!p),children:s[a.name]})})]},a.name))}),e.jsx(N,{header:"System Info",children:y.filter(a=>a.sector==="system").map(a=>e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"pl-6 text-[--tg-theme-hint-color]",children:a.displayName}),e.jsx(x,{multiline:p,onClick:()=>b(!p),children:s[a.name]})]},a.name))}),e.jsx(N,{header:"Other Info",children:y.filter(a=>a.sector==="others").map(a=>e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),e.jsx(x,{multiline:p,onClick:()=>b(!p),children:s[a.name]})]},a.name))}),e.jsx(N,{header:"Geolocation Info",children:he.map(a=>{var c;return e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),e.jsx(x,{multiline:p,onClick:()=>b(!p),children:(c=A[a.name])==null?void 0:c.toString()})]},a.name)})})]}),l&&e.jsx("div",{className:"sticky bottom-1",children:e.jsxs("div",{className:"flex flex-row justify-center items-center",children:[e.jsx(E,{className:"bg-green-400 w-full",onClick:L,children:"Confirm"}),e.jsx(E,{className:"bg-red-400 w-full",onClick:B,children:"Cancel"})]})})]})};export{je as Profile};
