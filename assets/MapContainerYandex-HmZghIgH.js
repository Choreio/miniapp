import{_ as ne,j as b,p as fe,l as oe,m as re,n as ie,r as g,e as Q,f as me,s as he,J as be,C as ge,K as ye,R as d}from"./index-BOnYdaJs.js";import{I as ve,L as je,C as X}from"./Input-C9N4m1aA.js";const Oe={bezeled:"tgui-93cba8aff2e72079",plain:"tgui-08ef1486bc111162",gray:"tgui-2250ff52f0b5cf71",outline:"tgui-53781f3cf83e8be1"},Ce={s:"tgui-b92d762e02762017",m:"tgui-024dfe77a8f2cfb0",l:"tgui-8ca1879e1128c105"},Ee=a=>{var{size:e="m",mode:s="bezeled",className:t,children:n}=a,c=ne(a,["size","mode","className","children"]);return b.jsx(fe,oe(re({Component:"button",className:ie("tgui-dda0e80fdf796ba5",Oe[s],Ce[e],t)},c),{children:n}))},we=a=>{var{withoutAnimation:e,visible:s,className:t,children:n}=a,c=ne(a,["withoutAnimation","visible","className","children"]);return b.jsx("div",oe(re({className:ie("tgui-97f2df57786b02dc",s&&"tgui-3eb6091f664c15d6",e&&"tgui-ecf101b3117a96c8",t)},c),{children:n}))};function Ae({title:a,titleId:e,...s},t){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},s),a?g.createElement("title",{id:e},a):null,g.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Re=g.forwardRef(Ae);let H;const Ue=({geoposition:a,setGeoposition:e,status:s})=>{const t=Q(me),n=Q(he),c=g.createRef(),[r,u]=g.useState(""),[i,o]=g.useState([]),[h,m]=g.useState(!1),[j,O]=g.useState(!1),k=()=>{O(!0)},C=()=>{O(!1)};g.useEffect(()=>{clearTimeout(H),r.length>0&&!h?H=setTimeout(()=>{be(n.languageCode||"en",r).then(f=>{console.log(f),o(f)}),k()},500):(o([]),C())},[r,h,n]);const z=f=>{const E=f.currentTarget.value;m(!1),u(E),o([]),C()};g.useEffect(()=>{C(),o([])},[a]);const D=(f,E)=>{console.log("Selected address"),u(f),m(!0),ye(n.languageCode||"en",r,E).then(w=>{console.log(w),e(w[0])}),C()},_=()=>{u(""),o([]),C()};return b.jsxs("div",{className:"relative overflow-visible self-stretch",ref:c,children:[b.jsx(ve,{after:r.length>0&&b.jsx(Ee,{onClick:_,children:b.jsx(Re,{className:"w-4 h-4"})}),value:r,status:s,placeholder:"Address...",onChange:z,onFocus:()=>{i.length>0&&k()}}),t.available&&b.jsx(ge,{className:"pl-8 text-[--tg-theme-link-color]",onClick:()=>{var f;e(t),u(((f=t==null?void 0:t.address)==null?void 0:f.formattedAdress)||""),m(!0)},children:"My address"}),j&&b.jsx("div",{className:"top-22 absolute z-20 -mt-2 w-full",children:b.jsxs(je,{className:"mr-8 ml-8 rounded-xl border border-solid border-gray-600 bg-[--tg-theme-secondary-bg-color]",children:[i.length>0&&i.map(f=>b.jsx("div",{onTouchEnd:E=>{E.preventDefault(),D(f.title,f.uri)},children:b.jsx(X,{Component:"div",className:"w-full",subtitle:f.subtitle,onClick:E=>{E.preventDefault(),D(f.title,f.uri)},children:f.title})},f.uri)),i.length===0&&b.jsx(X,{className:"w-full",children:"Not found"})]})})]})};function x(){return x=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(a[t]=s[t])}return a},x.apply(this,arguments)}const ae=(a,e)=>{const s={};for(const t in a)e.indexOf(t)===-1&&(s[t]=a[t]);return s},ce=d.createContext(null),V=d.createContext(null),le=a=>e=>d.createElement(V.Consumer,null,s=>d.createElement(a,x({parent:s},e))),xe=(a=[])=>{const[e,s]=g.useState(!1),t=g.useRef(a),n=(()=>{const r=g.useContext(ce);if(r===null)throw new Error("Couldn't find Yandex.Maps API in the context. Make sure that hook useYMaps is inside <YMaps /> provider");return r})(),c=n.getApi();return g.useEffect(()=>{n.load().then(()=>Promise.all(t.current.map(n.loadModule))).then(()=>s(!0))},[]),e&&c?c:null},ke=()=>{},_e=["onLoad","onError","modules","apiLoader"];function q(a,e=!1,s=[]){return t=>{const{width:n,height:c,modules:r=[],onLoad:u=ke}=t,i=xe(s.concat(r)),o=!e||!!i,h=ae(t,_e);return g.useEffect(()=>i?u(i):void 0,[i]),o?d.createElement(a,x({ymaps:i},h)):d.createElement("div",{style:{width:n,height:c}})}}const Ne=typeof window<"u",ee={lang:"ru_RU",load:"",ns:"",mode:"release"},Pe=a=>{const{version:e="2.1",enterprise:s=!1,query:t={lang:"ru_RU",load:"",ns:""},preload:n=!1,children:c}=a,r=g.useRef((u=>{const{query:i=ee}=u,o=Date.now().toString(32),h=i.ns||"",m="__yandex-maps-api-onload__$$"+o,j="__yandex-maps-api-onerror__$$"+o,O=Ne?window:{},k={};let C;const z=()=>h?O[h]:C,D=()=>{delete O[m],delete O[j]};return{load:()=>{if(z())return Promise.resolve(C);if(k[h])return k[h];const _={onload:m,onerror:j,...ee,...i},f=Object.keys(_).map(w=>`${w}=${_[w]}`).join("&"),E=[`https://${u.enterprise?"enterprise.":""}api-maps.yandex.ru`,u.version,"?"+f].join("/");return k[h]=new Promise((w,W)=>{O[m]=A=>{D(),A.ready(()=>{C=A,w(A)})},O[j]=A=>{D(),W(A)},(A=>new Promise((S,G)=>{const R=document.createElement("script");R.type="text/javascript",R.onload=S,R.onerror=G,R.src=A,R.async=!0,document.head.appendChild(R)}))(E).catch(O[j])}),k[h]},getApi:z,loadModule:_=>new Promise((f,E)=>{C.modules.require(_).done(w=>{w.forEach(W=>{((A,S,G,R=!1)=>{const Z=typeof S=="string"?S.split("."):S.slice();let L,I=A;for(;Z.length>1;)L=Z.shift(),I[L]||(I[L]={}),I=I[L];const $=Z[0];I[$]=R===!0&&I[$]||G})(C,_,W,!0)}),f(C)},E)})}})({version:e,enterprise:s,query:t,preload:n}));return g.useEffect(()=>{n&&r.current.load()},[r.current]),d.createElement(ce.Provider,{value:r.current},c)},te=/^on(?=[A-Z])/;function p(a){return Object.keys(a).reduce((e,s)=>{if(te.test(s)){const t=s.replace(te,"").toLowerCase();e._events[t]=a[s]}else e[s]=a[s];return e},{_events:{}})}function N(a,e,s){typeof s=="function"&&a.events.add(e,s)}function P(a,e,s){typeof s=="function"&&a.events.remove(e,s)}function T(a,e,s){Object.keys(Object.assign({},e,s)).forEach(t=>{e[t]!==s[t]&&(P(a,t,e[t]),N(a,t,s[t]))})}const ue=a=>"default"+a.charAt(0).toUpperCase()+a.slice(1);function y(a,e){return a[e]!==void 0||a[ue(e)]===void 0}function l(a,e,s){return(y(a,e)?a[e]:a[ue(e)])||s}function v(a,e,s=null){if(a!==e){if(a&&("current"in a?a.current=null:typeof a=="function"&&a(null)),!e)return;"current"in e?e.current=s:typeof e=="function"&&e(s)}}function pe(a){const{width:e,height:s,style:t,className:n}=a;return t!==void 0||n!==void 0?Object.assign({},t&&{style:t},n&&{className:n}):{style:{width:e,height:s}}}class Ie extends d.Component{constructor(e){super(e),this.state={error:null,errorInfo:null}}componentDidCatch(e,s){const{onError:t=()=>{}}=this.props;t(e),this.setState({error:e,errorInfo:s})}render(){return this.state.error?null:this.props.children}}const Y=a=>({onError:e,...s})=>d.createElement(Ie,{onError:e},d.createElement(a,s));class U extends d.Component{constructor(){super(),this.instance=null,this.state={instance:null},this._parentElement=null,this._getRef=e=>{this._parentElement=e}}componentDidMount(){this.instance=U.mountObject(this._parentElement,this.props.ymaps.Map,this.props),this.setState({instance:this.instance})}componentDidUpdate(e){this.instance!==null&&U.updateObject(this.instance,e,this.props)}componentWillUnmount(){U.unmountObject(this.instance,this.props)}render(){const e=pe(this.props),s=p(this.props),t=ae(s,["_events","state","defaultState","options","defaultOptions","instanceRef","ymaps","children","width","height","style","className"]);return d.createElement(V.Provider,{value:this.state.instance},d.createElement("div",x({ref:this._getRef},e,t),this.props.children))}static mountObject(e,s,t){const{instanceRef:n,_events:c}=p(t),r=new s(e,l(t,"state"),l(t,"options"));return Object.keys(c).forEach(u=>N(r,u,c[u])),v(null,n,r),r}static updateObject(e,s,t){const{_events:n,instanceRef:c}=p(t),{_events:r,instanceRef:u}=p(s);if(y(t,"state")){const i=l(s,"state",{}),o=l(t,"state",{});i.type!==o.type&&e.setType(o.type),i.behaviors!==o.behaviors&&(i.behaviors&&e.behaviors.disable(i.behaviors),o.behaviors&&e.behaviors.enable(o.behaviors)),o.zoom&&i.zoom!==o.zoom&&e.setZoom(o.zoom),o.center&&i.center!==o.center&&e.setCenter(o.center),o.bounds&&i.bounds!==o.bounds&&e.setBounds(o.bounds)}if(y(t,"options")){const i=l(s,"options"),o=l(t,"options",{});i!==o&&e.options.set(o)}l(s,"width")===l(t,"width")&&l(s,"height")===l(t,"height")||e.container.fitToViewport(),T(e,r,n),v(u,c,e)}static unmountObject(e,s){const{instanceRef:t,_events:n}=p(s);e!==null&&(Object.keys(n).forEach(c=>P(e,c,n[c])),e.destroy(),v(t))}}const de=Y(q(U,!0,["Map"]));de.defaultProps={width:320,height:240};class K extends d.Component{constructor(){super(),this.state={instance:null},this._parentElement=null,this._getRef=e=>{this._parentElement=e}}componentDidMount(){this._mounted=!0,this.props.ymaps.panorama.isSupported()&&K.mountObject(this._parentElement,this.props.ymaps.panorama,this.props).then(e=>this._mounted&&this.setState({instance:e}))}componentDidUpdate(e){this.state.instance!==null&&K.updateObject(this.state.instance,e,this.props)}componentWillUnmount(){this._mounted=!1,K.unmountObject(this.state.instance,this.props)}render(){const e=pe(this.props);return d.createElement("div",x({ref:this._getRef},e))}static mountObject(e,s,t){const{instanceRef:n,_events:c}=p(t),r=l(t,"point"),u=l(t,"locateOptions"),i=l(t,"options");return new Promise((o,h)=>{s.locate(r,u).done(m=>{if(m.length>0){const j=new s.Player(e,m[0],i);v(null,n,j),Object.keys(c).forEach(O=>N(j,O,c[O])),o(j)}},h)})}static updateObject(e,s,t){const{_events:n,instanceRef:c}=p(t),{_events:r,instanceRef:u}=p(s);if(y(t,"options")){const i=l(s,"options"),o=l(t,"options");i!==o&&e.options.set(o)}if(y(t,"point")){const i=l(t,"point"),o=l(s,"point"),h=l(t,"locateOptions");i!==o&&e.moveTo(i,h)}T(e,r,n),v(u,c,e)}static unmountObject(e,s){const{instanceRef:t,_events:n}=p(s);e!==null&&(Object.keys(n).forEach(c=>P(e,c,n[c])),v(t))}}class B extends d.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const e=B.mountControl(this.props.ymaps.control[this.props.name],this.props);this.instance=e,this.setState({instance:e})}componentDidUpdate(e){this.instance!==null&&B.updateControl(this.instance,e,this.props)}componentWillUnmount(){B.unmountControl(this.instance,this.props)}render(){return d.createElement(V.Provider,{value:this.state.instance},this.props.children)}static mountControl(e,s){const{instanceRef:t,parent:n,lazy:c,_events:r}=p(s),u=new e({data:l(s,"data"),options:l(s,"options"),state:l(s,"state"),mapTypes:l(s,"mapTypes"),lazy:c});if(Object.keys(r).forEach(i=>N(u,i,r[i])),n&&n.controls&&typeof n.controls.add=="function")n.controls.add(u);else{if(!n||!n.add||typeof n.add!="function")throw new Error(`No parent found to mount ${s.name}`);n.add(u)}return v(null,t,u),u}static updateControl(e,s,t){const{_events:n,instanceRef:c}=p(t),{_events:r,instanceRef:u}=p(s);if(y(t,"options")){const i=l(s,"options"),o=l(t,"options");i!==o&&e.options.set(o)}if(y(t,"data")){const i=l(s,"data"),o=l(t,"data");i!==o&&e.data.set(o)}if(y(t,"state")){const i=l(s,"state"),o=l(t,"state");i!==o&&e.state.set(o)}if(y(t,"mapTypes")){const i=l(s,"mapTypes"),o=l(t,"mapTypes");i!==o&&(e.removeAllMapTypes(),o.forEach(h=>e.addMapType(h)))}T(e,r,n),v(u,c,e)}static unmountControl(e,s){const{instanceRef:t,parent:n,_events:c}=p(s);e!==null&&(Object.keys(c).forEach(r=>P(e,r,c[r])),n.controls&&typeof n.controls.remove=="function"?n.controls.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),v(t))}}class F extends d.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const e=F.mountObject(this.props.ymaps.Clusterer,this.props);this.instance=e,this.setState({instance:e})}componentDidUpdate(e){this.state.instance!==null&&F.updateObject(this.instance,e,this.props)}componentWillUnmount(){F.unmountObject(this.instance,this.props)}render(){return d.createElement(V.Provider,{value:this.state.instance},this.props.children)}static mountObject(e,s){const{instanceRef:t,parent:n,_events:c}=p(s),r=new e(l(s,"options"));if(Object.keys(c).forEach(u=>N(r,u,c[u])),n.geoObjects&&typeof n.geoObjects.add=="function")n.geoObjects.add(r);else{if(!n.add||typeof n.add!="function")throw new Error("No parent found to mount Clusterer");n.add(r)}return v(null,t,r),r}static updateObject(e,s,t){const{_events:n,instanceRef:c}=p(t),{_events:r,instanceRef:u}=p(s);if(y(t,"options")){const i=l(s,"options"),o=l(t,"options");i!==o&&e.options.set(o)}T(e,r,n),v(u,c,e)}static unmountObject(e,s){const{instanceRef:t,parent:n,_events:c}=p(s);e!==null&&(Object.keys(c).forEach(r=>P(e,r,c[r])),n.geoObjects&&typeof n.geoObjects.remove=="function"?n.geoObjects.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),v(t))}}class J extends d.Component{constructor(){super(),this.state={instance:null}}componentDidMount(){const e=J.mountObject(this.props.ymaps.ObjectManager,this.props);this.instance=e,this.setState({instance:e})}componentDidUpdate(e){this.instance!==null&&J.updateObject(this.instance,e,this.props)}componentWillUnmount(){J.unmountObject(this.instance,this.props)}render(){return null}static mountObject(e,s){const{instanceRef:t,parent:n,_events:c}=p(s),r=l(s,"options",{}),u=l(s,"features",{}),i=l(s,"filter",null),o=l(s,"objects",{}),h=l(s,"clusters",{}),m=new e(r);if(m.add(u||[]),m.setFilter(i),m.objects.options.set(o),m.clusters.options.set(h),Object.keys(c).forEach(j=>N(m,j,c[j])),n.geoObjects&&typeof n.geoObjects.add=="function")n.geoObjects.add(m);else{if(!n.add||typeof n.add!="function")throw new Error("No parent found to mount ObjectManager");n.add(m)}return v(null,t,m),m}static updateObject(e,s,t){const{_events:n,instanceRef:c}=p(t),{_events:r,instanceRef:u}=p(s);if(y(t,"options")){const i=l(s,"options"),o=l(t,"options");i!==o&&e.options.set(o)}if(y(t,"objects")){const i=l(s,"objects"),o=l(t,"objects");i!==o&&e.objects.options.set(o)}if(y(t,"clusters")){const i=l(s,"clusters"),o=l(t,"clusters");i!==o&&e.clusters.options.set(o)}if(y(t,"filter")){const i=l(s,"filter"),o=l(t,"filter");i!==o&&e.setFilter(o)}if(y(t,"features")){const i=l(s,"features"),o=l(t,"features");i!==o&&(e.remove(i),e.add(o))}T(e,r,n),v(u,c,e)}static unmountObject(e,s){const{instanceRef:t,parent:n,_events:c}=p(s);e!==null&&(Object.keys(c).forEach(r=>P(e,r,c[r])),n.geoObjects&&typeof n.geoObjects.remove=="function"?n.geoObjects.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),v(t))}}class M extends d.Component{constructor(){super(),this.state={instance:null},this.instance=null}componentDidMount(){const{name:e,ymaps:s,dangerZone:t}=this.props,n=M.mountObject(t&&typeof t.modifyConstructor=="function"?t.modifyConstructor(s[e]):s[e],this.props);this.instance=n,this.setState({instance:n})}componentDidUpdate(e){this.instance!==null&&M.updateObject(this.instance,e,this.props)}componentWillUnmount(){M.unmountObject(this.instance,this.props)}render(){return null}static mountObject(e,s){const{instanceRef:t,parent:n,_events:c}=p(s),r=new e(l(s,"geometry"),l(s,"properties"),l(s,"options"));if(Object.keys(c).forEach(u=>N(r,u,c[u])),n&&n.geoObjects&&typeof n.geoObjects.add=="function")n.geoObjects.add(r);else{if(!n||!n.add||typeof n.add!="function")throw new Error(`No parent found to mount ${s.name}`);n.add(r)}return v(null,t,r),r}static updateObject(e,s,t){const{_events:n,instanceRef:c}=p(t),{_events:r,instanceRef:u}=p(s);if(y(t,"geometry")){const i=l(s,"geometry",{}),o=l(t,"geometry",{});Array.isArray(o)&&o!==i?Array.isArray(o[0])&&typeof o[1]=="number"?(e.geometry.setCoordinates(o[0]),e.geometry.setRadius(o[1])):e.geometry.setCoordinates(o):typeof o=="object"&&(o.coordinates!==i.coordinates&&e.geometry.setCoordinates(o.coordinates),o.radius!==i.radius&&e.geometry.setRadius(o.radius))}if(y(t,"properties")){const i=l(s,"properties"),o=l(t,"properties");i!==o&&e.properties.set(o)}if(y(t,"options")){const i=l(s,"options"),o=l(t,"options");i!==o&&e.options.set(o)}T(e,r,n),v(u,c,e)}static unmountObject(e,s){const{instanceRef:t,parent:n,_events:c}=p(s);e!==null&&(Object.keys(c).forEach(r=>P(e,r,c[r])),n.geoObjects&&typeof n.geoObjects.remove=="function"?n.geoObjects.remove(e):n.remove&&typeof n.remove=="function"&&n.remove(e),v(t))}}var Me=Y(le(q(a=>d.createElement(M,x({},a,{name:"Circle"})),!0,["Circle"]))),se=Y(le(q(a=>d.createElement(M,x({},a,{name:"Placemark"})),!0,["Placemark"])));const Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAYCAYAAADOMhxqAAAAAXNSR0IArs4c6QAAAZtJREFUOE+V079rFUEQwPHPXDAqJgpKiCKoKGKKKCL+QGzs5Floq00KKy3F1t5GLGwsBAVt1EZsBP8BGysJIaJFEhAkKCkkQhKTN3L37oJ5+J66sMXuzXd35jt74T9H/E/8Jk4HxRPaE/8IfipvuKzQ0na9gQZorfFa+TVdw2NDRix61KS0hJe4WkLBcorBMrpCKDCP8x1g0JgV05jCePAxOVzD35K7wh2pWC86eJVcwsp29nznobB1c7q5LD6QTzHRbWlVGIis8mhJbyKspiiM5LCvFruBcWGyBspi5qT9xCI5XKfYJTRMS2PNbkeUW7j3Z4DdwZfKz/oYHWL+Ry+g1LpW5d3RuiGu19P4TOytgZ+V+G6yq5I57Ks7vYBdfwOWm1ODmeRgXyDIrI8PppLxfsBJvKtmOCW9x/F+wNvgbNq5g4VZlPNEP6B0OYljeI5DKG/d6Lez3HKApZnaSmmnFdxOzvUAivuifUE6UgcM4QUu9gBiljxT/yxVTMGDNjd6AZPk0d+bOMCVNZ71AEa3NY+sCUii7Euz/gWH83ELgnv1NgAAAABJRU5ErkJggg==",ze=({available:a,className:e,type:s,center:t,points:n,radius:c=0})=>b.jsx(Pe,{query:{lang:"en_US"},children:a?b.jsxs(de,{className:e,state:{center:[t.latitude,t.longitude],zoom:12.5,controls:["zoomControl","fullscreenControl"]},modules:["control.ZoomControl","control.FullscreenControl"],options:{autoFitToViewport:"always"},children:[b.jsx(se,{id:"self",geometry:[t.latitude,t.longitude],options:s==="self"?{iconLayout:"default#image",iconImageClipRect:[[0,0],[12,24]],iconImageHref:Te,iconImageSize:[12,24],iconImageOffset:[-6,-12]}:{iconColor:"red"}}),n&&(n==null?void 0:n.length)>0&&n.map(r=>b.jsx(se,{id:"taskNo"+r.taskId,geometry:[r.latitude,r.longitude],onClick:r.onBubbleClick},r.taskId)),c<1/0&&b.jsx(Me,{geometry:[[t.latitude,t.longitude],c],options:{fillOpacity:.2,fillColor:"#dde6d5",strokeColor:"#a3b899"}})]}):b.jsx(we,{visible:!0,className:"w-96 h-48"})});export{Re as F,Ue as G,Ee as I,ze as M};
