const __vite__fileDeps=["./MapPage-QKcj6oWU.js","./index-B8HkePtc.js","./index-C1V8AkYQ.css","./calcDistance-DP--JZw4.js","./Input-Cj31vOeN.js","./TaskCard-im4AJMaZ.js","./FileInput-DOu96ZsA.js","./TasksList-CAwsA2Oz.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as a,_ as F,h as D,k as V,l as q,m as Z,n as ne,S as Te,r as i,o as Ne,p as Pe,q as Me,v as ge,R as Ce,w as Re,J as Le,c as te,s as ye,x as Ae,d as Xe,P as _e,T as De}from"./index-B8HkePtc.js";import{c as _,G as ke,S as Ye,a as he,F as Ie}from"./calcDistance-DP--JZw4.js";import{_ as Ve,a as Be,F as Fe,V as He,S as Oe}from"./Input-Cj31vOeN.js";const Y=(e,t,s)=>Math.max(t,Math.min(e,s)),Ze=e=>{var t=Ve({},Be(e));return a.jsx("svg",F(D({width:"20",height:"20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),{children:a.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.29289 6.29289c.39053-.39052 1.02369-.39052 1.41422 0L10 11.5858l5.2929-5.29291c.3905-.39052 1.0237-.39052 1.4142 0 .3905.39053.3905 1.02369 0 1.41422l-6 5.99999c-.3905.3905-1.02368.3905-1.41421 0l-6-5.99999c-.39052-.39053-.39052-1.02369 0-1.41422Z",fill:"currentColor"})}))},We=e=>{var{header:t,before:s,status:n,className:l}=e,d=V(e,["header","before","status","className"]);const u=q(),v=u==="ios"?ne:Te;return a.jsxs(Fe,{header:t,before:s,status:n,className:Z("tgui-919c5658483cae11",u==="ios"&&"tgui-5edcb8465ee11055",l),children:[a.jsx(v,D({Component:"select",className:"tgui-a0742fd4c73756f7",multiple:!1},d)),a.jsx(Ze,{"aria-hidden":!0,className:"tgui-025a45d791e466f6"})]})};function B(e,t,s){const n=i.useRef(t);Ne(()=>{n.current=t},[t]);const l=i.useCallback(f=>n.current&&n.current(f),[]),d=i.useRef(()=>{}),u=i.useCallback(()=>{d.current(),d.current=()=>{}},[]),v=i.useCallback(f=>{if(!Pe||(u(),!f))return;const R=D({},s);f.addEventListener(e,l,R),d.current=()=>f.removeEventListener(e,l,R)},[s,l,e,u]);return i.useEffect(()=>u,[u]),i.useMemo(()=>({add:v,remove:u}),[v,u])}const $e=(e,t)=>({startX:e,startY:t,startT:new Date,duration:0,isPressed:!0,isY:!1,isX:!1,isSlideX:!1,isSlideY:!1,isSlide:!1,clientX:0,clientY:0,shiftX:0,shiftY:0,shiftXAbs:0,shiftYAbs:0}),me=e=>e.clientX!=null?e.clientX:e.changedTouches&&e.changedTouches[0].clientX,ve=e=>e.clientY!=null?e.clientY:e.changedTouches&&e.changedTouches[0].clientY,ae=()=>Pe&&"ontouchstart"in window,ze=()=>ae()?["touchstart","touchmove","touchend","touchcancel"]:["mousedown","mousemove","mouseup","mouseleave"],Ge=e=>{var{Component:t="div",onStart:s,onStartX:n,onStartY:l,onMove:d,onMoveX:u,onMoveY:v,onLeave:f,onEnter:R,onEnd:m,onEndX:M,onEndY:S,onClickCapture:w,usePointerHover:h,slideThreshold:j=5,useCapture:x=!1,noSlideClick:E=!1,stopPropagation:N=!1}=e,c=V(e,["Component","onStart","onStartX","onStartY","onMove","onMoveX","onMoveY","onLeave","onEnter","onEnd","onEndX","onEndY","onClickCapture","usePointerHover","slideThreshold","useCapture","noSlideClick","stopPropagation"]);const p=i.useMemo(ze,[]),k=i.useRef(!1),b=i.useRef(null),I=(r,g)=>{N&&r.stopPropagation(),g.forEach(T=>{var C,y,A;const X=Date.now()-((A=(y=b.current)===null||y===void 0||(C=y.startT)===null||C===void 0?void 0:C.getTime())!==null&&A!==void 0?A:0);T&&T(F(D({},b.current),{duration:X,originalEvent:r}))})},H={capture:x,passive:!1},W=[B(p[1],re,H),B(p[2],o,H),B(p[3],o,H)],J=r=>{r&&W.forEach(g=>g.add(r))},K=()=>{W.forEach(r=>r.remove())},$=B(h?"pointerenter":"mouseenter",R),O=B(h?"pointerleave":"mouseleave",f),Q=B(p[0],r=>{b.current=$e(me(r),ve(r)),I(r,[s,n,l]),J(ae()?r.target:window.document)},{capture:x,passive:!1}),z=i.useRef();Ne(()=>{const r=z.current;r&&($.add(r),O.add(r),Q.add(r))},[t]);function re(r){var g;const{isPressed:T,isX:C,isY:y,startX:A=0,startY:X=0}=(g=b.current)!==null&&g!==void 0?g:{};if(T){var ee;const oe=me(r),le=ve(r),ie=oe-A,ce=le-X,G=Math.abs(ie),U=Math.abs(ce);if(r.touches&&r.touches.length>1){o(r);return}if(!C&&!y){const ue=G>=j&&G>U,de=U>=j&&U>G,fe=ue&&(!!u||!!d),pe=de&&(!!v||!!d);b.current&&Object.assign(b.current,{isY:de,isX:ue,isSlideX:fe,isSlideY:pe,isSlide:fe||pe})}!((ee=b.current)===null||ee===void 0)&&ee.isSlide&&(Object.assign(b.current,{clientX:oe,clientY:le,shiftX:ie,shiftY:ce,shiftXAbs:G,shiftYAbs:U}),I(r,[d,b.current.isSlideX&&u,b.current.isSlideY&&v]))}}function o(r){var g;const{isPressed:T,isSlide:C,isSlideX:y,isSlideY:A}=(g=b.current)!==null&&g!==void 0?g:{};T&&I(r,[m,A&&S,y&&M]);const X=ae();X&&C?k.current=!1:k.current=!!C,b.current={},X&&f&&f(r),K()}const P=r=>{const g=r.target;(g.tagName==="A"||g.tagName==="IMG")&&r.preventDefault()},L=r=>{if(!k.current){w&&w(r);return}E?(r.stopPropagation(),r.preventDefault()):w&&w(r),k.current=!1};return a.jsx(t,F(D({},c),{onDragStart:P,onClickCapture:L,ref:z}))},Ue=({steps:e})=>{const t=q();return a.jsx(a.Fragment,{children:e.map(({isPassed:s,XCoordinate:n})=>a.jsx("div",{className:Z("tgui-b632646f586ff14d",{"tgui-7951a89b824476b3":t==="ios","tgui-2b0a006b5a9ffd68":s}),style:{left:`${n}%`}},n))})},xe=i.forwardRef((e,t)=>{var{className:s,inputProps:n,withTooltip:l}=e,d=V(e,["className","inputProps","withTooltip"]);const u=q();return a.jsx("span",F(D({className:Z("tgui-83b7253102c6addc",u==="ios"&&"tgui-96f5864d281f94a8",s)},d),{children:a.jsx(He,F(D({},n),{Component:"input",type:"range",ref:t,className:Z("tgui-abdeb837bfc726cb",s),"aria-orientation":"horizontal"}))}))}),qe=e=>{const{"aria-label":t,"aria-valuetext":s,"aria-labelledby":n}=e,l=V(e,["aria-label","aria-valuetext","aria-labelledby"]);return D({aria:{ariaLabel:t,ariaValueText:s,ariaLabelledBy:n}},l)},be=e=>e&&["start","end"].includes(e.dataset.type||"")?e.dataset.type:null,Je=e=>{if(Math.abs(e)<1){const s=e.toExponential().split("e-"),n=s[0].split(".")[1];return(n?n.length:0)+parseInt(s[1],10)}const t=e.toString().split(".")[1];return t?t.length:0},Ke=(e,t,s)=>{const n=Math.round((e-s)/t)*t+s;return Number(n.toFixed(Je(t)))},Qe=(e,t,s,n)=>{if(n==null||n<=0)return Y(e,t,s);const l=Ke(e,n,t);return Y(l,t,s)},et=(e,t,s,n={})=>{const l=(e-t[0])/(t[1]-t[0])*(s[1]-s[0])+s[0];return Qe(l,s[0],s[1],n.step)},se=(e,t,s)=>(e-t)/(s-t)*100,Se=(e,t,s,n,l)=>et(e,[0,t],[s,n],{step:l}),we=(e,t,s,n,l)=>{const[d,u]=e;if(u===null)return[Y(t,s,n),null];switch(l){case"start":return t>u?[u,u]:[Y(t,s,n),u];case"end":return t<d?[d,d]:[d,Y(t,s,n)];case null:default:return e}},tt=(e,t,s)=>{const[n,l]=e;switch(s){case"start":return[t,l];case"end":return[n,t];case null:default:return e}},st=e=>e[1]!==null,je=.1,nt=(e,t,s)=>{if(s==="start"||s==="end")return s;const[n,l]=e,d=l!==null?n-je:n,u=l!==null?l+je:0;return Math.abs(d-t)<=Math.abs(u-t)?"start":"end"},at=e=>{var{step:t=1,min:s=0,max:n=100,value:l,multiple:d,defaultValue:u=d?[s,n]:s,disabled:v,getAriaLabel:f,getAriaValueText:R,onChange:m}=e,M=V(e,["step","min","max","value","multiple","defaultValue","disabled","getAriaLabel","getAriaValueText","onChange"]);const S=l!==void 0,[w,h]=i.useState(u),j=i.useMemo(()=>{const o=S?l:w;return Array.isArray(o)?[Y(o[0],s,n),Y(o[1],s,n)]:[Y(o,s,n),null]},[S,l,w,s,n]),[x,E]=j,N=d&&E!==null,c=i.useRef({dragging:null,startX:0,containerWidth:0}).current,p=i.useRef(null),k=i.useRef(null),b=i.useRef(null),I=(o,P)=>{v||Me(o[0],o[1])||(d?st(o)&&(!S&&h(o),m&&m(o,P)):(!S&&h(o[0]),m&&m(o[0],P)))},H=o=>{if(!p.current)return;const{left:P,width:L}=p.current.getBoundingClientRect();if(!(o.originalEvent.target instanceof HTMLElement))return;const r=be(o.originalEvent.target),g=o.startX-P,T=Se(g,L,s,n,t),C=nt(j,T,r);c.dragging=C,c.containerWidth=L,c.startX=g;const y=we(j,T,s,n,C),[A,X]=y;k.current&&(r==="start"||A!==x&&X===E)?(k.current.focus(),o.originalEvent.preventDefault()):b.current&&(r==="end"||X!==E&&A===x)&&(b.current.focus(),o.originalEvent.preventDefault()),I(y,o),o.originalEvent.stopPropagation()},W=o=>{const{startX:P,containerWidth:L,dragging:r}=c,{shiftX:g=0}=o,T=P+g,C=Se(T,L,s,n,t);I(we(j,C,s,n,r),o),o.originalEvent.stopPropagation(),o.originalEvent.preventDefault()},J=o=>{c.dragging=null,o.originalEvent.stopPropagation()},K=o=>{I(tt(j,Number(o.target.value),be(o.target)),o)},$=qe(M),{aria:O}=$,Q=V($,["aria"]),z=o=>{const P=o?1:0;return{"data-type":o?"end":"start",step:t,min:s,value:o&&N?E:x,max:!o&&N?E:n,disabled:v,"aria-label":f?f(P):O.ariaLabel,"aria-valuetext":R?R(x,P):O.ariaValueText,"aria-labelledby":O.ariaLabelledBy,onChange:K}};return{steps:(()=>{if(t===1)return;const o=[],P=Math.floor((n-s)/t);for(let L=0;L<=P;L+=1){const r=s+L*t,g=N?r>=x&&r<=E:r<=x;o.push({isPassed:g,XCoordinate:se(r,s,n)})}return o})(),multiple:N,containerProps:Q,startValueInPercent:se(x,s,n),endReversedValueInPercent:N?se(E,s,n):0,thumbsContainerRef:p,thumbStartInputRef:k,thumbEndInputRef:b,handlePointerStart:H,handlePointerMove:W,handlePointerEnd:J,getInputProps:z}},rt=e=>{var{className:t,disabled:s,before:n,after:l}=e,d=V(e,["className","disabled","before","after"]);const u=q(),{steps:v,multiple:f,containerProps:R,startValueInPercent:m,endReversedValueInPercent:M,thumbsContainerRef:S,thumbStartInputRef:w,thumbEndInputRef:h,handlePointerStart:j,handlePointerMove:x,handlePointerEnd:E,getInputProps:N}=at(d);return a.jsxs("div",{className:Z("tgui-717c3649db8d5af2",u==="ios"&&"tgui-d2e2a2e28ef0f746",s&&"tgui-c591a831de13ba23",t),children:[ge(n)&&a.jsx("div",{className:"tgui-6598607160233201",children:n}),a.jsxs(Ge,F(D({},R),{className:"tgui-35faba867393ce37",onStart:s?void 0:j,onMove:s?void 0:x,onEnd:s?void 0:E,children:[a.jsx("div",{className:"tgui-e11a455378c63b15",children:v!==void 0&&a.jsx(Ue,{steps:v})}),a.jsx("div",{className:"tgui-4de4feff2dcc975c",style:f?{left:`${m}%`,right:`${100-M}%`}:{width:`${m}%`}}),a.jsxs("div",{ref:S,className:"tgui-7fe9f0fbc9771947",children:[a.jsx(xe,{"data-type":"start",ref:w,style:{left:`${m}%`,zIndex:f&&m>=50?3:void 0},inputProps:N(!1)}),f&&a.jsx(xe,{"data-type":"end",ref:h,style:{left:`${M}%`},inputProps:N(!0)})]})]})),ge(l)&&a.jsx("div",{className:"tgui-a56564bcfd4b56e5",children:l})]})};function ot({title:e,titleId:t,...s},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},s),e?i.createElement("title",{id:t},e):null,i.createElement("path",{fillRule:"evenodd",d:"M2.25 4.5A.75.75 0 0 1 3 3.75h14.25a.75.75 0 0 1 0 1.5H3a.75.75 0 0 1-.75-.75Zm0 4.5A.75.75 0 0 1 3 8.25h9.75a.75.75 0 0 1 0 1.5H3A.75.75 0 0 1 2.25 9Zm15-.75A.75.75 0 0 1 18 9v10.19l2.47-2.47a.75.75 0 1 1 1.06 1.06l-3.75 3.75a.75.75 0 0 1-1.06 0l-3.75-3.75a.75.75 0 1 1 1.06-1.06l2.47 2.47V9a.75.75 0 0 1 .75-.75Zm-15 5.25a.75.75 0 0 1 .75-.75h9.75a.75.75 0 0 1 0 1.5H3a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"}))}const lt=i.forwardRef(ot);function it({title:e,titleId:t,...s},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},s),e?i.createElement("title",{id:t},e):null,i.createElement("path",{fillRule:"evenodd",d:"M2.25 4.5A.75.75 0 0 1 3 3.75h14.25a.75.75 0 0 1 0 1.5H3a.75.75 0 0 1-.75-.75Zm14.47 3.97a.75.75 0 0 1 1.06 0l3.75 3.75a.75.75 0 1 1-1.06 1.06L18 10.81V21a.75.75 0 0 1-1.5 0V10.81l-2.47 2.47a.75.75 0 1 1-1.06-1.06l3.75-3.75ZM2.25 9A.75.75 0 0 1 3 8.25h9.75a.75.75 0 0 1 0 1.5H3A.75.75 0 0 1 2.25 9Zm0 4.5a.75.75 0 0 1 .75-.75h5.25a.75.75 0 0 1 0 1.5H3a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"}))}const ct=i.forwardRef(it),ut=Ce.lazy(()=>Re(()=>import("./MapPage-QKcj6oWU.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(({MapPage:e})=>({default:e}))),Ee=Ce.lazy(()=>Re(()=>import("./TasksList-CAwsA2Oz.js"),__vite__mapDeps([7,1,2,4,5,3,6]),import.meta.url).then(({TasksList:e})=>({default:e}))),gt=()=>{const e=Le(),[t,s]=i.useState("list"),n=c=>{console.log("Changing mode"),s(c)},[l,d]=i.useState(1),[u,v]=i.useState(1e3);i.useEffect(()=>{l<10?v(l*1e3):v(1/0)},[l]);const[f,R]=i.useState("default"),[m,M]=i.useState("desc"),S=te(ye),w=te(Ae),h=te(Xe),j=i.useMemo(()=>w.filter(c=>c.acceptedBy!==S.id&&c.status==="open"&&c.customer!==S.id&&_(h.latLong,c.location.latLong)*1e3<=u).sort((c,p)=>f==="default"?m==="asc"?(console.log("Default sorting ascending"),c.id<p.id?-1:c.id>p.id?1:0):(console.log("Default sorting descending"),c.id<p.id?1:c.id>p.id?-1:0):f==="distance"?m==="asc"?(console.log("Distance sorting ascending"),_(c.location.latLong,h.latLong)<_(p.location.latLong,h.latLong)?-1:_(c.location.latLong,h.latLong)>_(p.location.latLong,h.latLong)?1:0):(console.log("Distance sorting descending"),_(c.location.latLong,h.latLong)<_(p.location.latLong,h.latLong)?1:_(c.location.latLong,h.latLong)>_(p.location.latLong,h.latLong)?-1:0):f==="reward"?m==="asc"?(console.log("Reward sorting ascending"),console.log(c.reward.split(" ")[0]+" < "+p.reward.split(" ")[0]),Number(c.reward.split(" ")[0])<Number(p.reward.split(" ")[0])?-1:Number(c.reward.split(" ")[0])>Number(p.reward.split(" ")[0])?1:0):(console.log("Reward sorting descending"),Number(c.reward.split(" ")[0])<Number(p.reward.split(" ")[0])?1:Number(c.reward.split(" ")[0])>Number(p.reward.split(" ")[0])?-1:0):0),[w,S,h,u,m,f]),x=i.useMemo(()=>w.filter(c=>c.acceptedBy===S.id&&c.status==="active"),[w,S]),[E,N]=i.useState(!0);return i.useEffect(()=>{console.log("Force redo accordeon"),N(!1),setTimeout(()=>{N(!0)},50)},[j,x]),e?h.available?a.jsx("div",{className:"md:container md:mx-auto",children:a.jsxs(Oe,{className:"pt-4 h-full",header:a.jsxs("div",{className:"p-2 flex align-middle items-center justify-between w-full",children:[a.jsx(De,{className:"self-start",children:"Tasks"}),a.jsxs(Ye,{className:"w-40 h-8 self-end z-[0]",children:[a.jsx(he,{className:"w-4 h-8 align-middle p-1",selected:t==="list",onClick:()=>{n("list")},children:"List"}),a.jsx(he,{selected:t==="map",className:"w-4 h-8 align-middle p-1",onClick:()=>{n("map")},children:"Map"})]})]}),children:[t==="list"&&a.jsxs("div",{className:"pl-4 pr-4 flex justify-between items-center w-full",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ne,{children:"Sort by:"}),a.jsxs(We,{value:f,onChange:c=>{R(c.currentTarget.value)},children:[a.jsx("option",{value:"default",children:"Default"}),a.jsx("option",{value:"distance",children:"Distance"}),a.jsx("option",{value:"reward",children:"Reward"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[m==="desc"?a.jsx(lt,{className:"h-8 w-8",onClick:()=>M("asc")}):a.jsx(ct,{className:"h-8 w-8",onClick:()=>M("desc")}),(m!=="desc"||f!=="default")&&a.jsx(Ie,{className:"h-8 w-8",onClick:()=>{M("desc"),R("default")}})]})]}),a.jsxs("div",{className:"pl-8 pt-4 pr-8",children:[a.jsxs(ne,{className:"flex",children:["You are looking for tasks in ",u," meters from your current position"]}),a.jsx(rt,{step:1,value:l,min:1,max:10,onChange:c=>{console.log("Slider change!"),d(c)}})]}),t==="list"?a.jsxs(a.Fragment,{children:[a.jsx(Ee,{title:"Accepted tasks",tasks:x,mode:"view",open:E}),a.jsx(Ee,{title:"Available tasks",tasks:j,mode:"view",open:E})]}):a.jsx(a.Fragment,{children:a.jsx(ut,{parent:"Tasks",tasks:[...x,...j],position:h,radius:u})})]})}):a.jsx(ke,{}):a.jsx(_e,{header:"Oops",description:"Application was launched with missing init data",children:a.jsx("img",{alt:"Telegram sticker",src:"https://xelene.me/telegram.gif",style:{display:"block",width:"144px",height:"144px"}})})};export{gt as TasksTab};
