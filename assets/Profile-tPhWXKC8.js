import{r as l,_ as E,b as L,j as e,T as O,c as S,h as w,d as v,e as R,S as M,f as H,J,P as G,i as z,t as q,k as f,s as P,l as K,m as V,n as W,E as Y,o as Z,p as $,q as Q,C as j,B as X,v as ee}from"./index-U8tIbSpk.js";import{_ as ae,a as se,S as g,B as U,b,c as N,C as x}from"./Section-mniEePPg.js";import{A as te}from"./Avatar-B7F1Xbgd.js";import{I as le}from"./Input-ZVJasjWp.js";import"./function-ChqatQlo.js";const re=l.forwardRef((r,n)=>{var{mode:c="default",before:t,after:o,className:i,children:h,Component:d}=r,C=E(r,["mode","before","after","className","children","Component"]);const s=L(),m=s==="ios"?M:H;return e.jsxs(O,S(v({ref:n,Component:d||"button",className:R("tgui-a8ce18a8594cea9b",c==="destructive"&&"tgui-6e7ca796043fe6ca",s==="ios"&&"tgui-f464dba82cb8b46e",i)},C),{children:[w(t)&&t,w(h)&&e.jsx(m,{children:h}),w(o)&&o]}))}),ne=l.forwardRef((r,n)=>{var{Component:c="span",className:t}=r,o=E(r,["Component","className"]);return e.jsx(c,S(v({},o),{ref:n,className:R("tgui-b9fd8cdf929947df",t)}))}),oe=r=>{var n=ae({},se(r));return e.jsx("svg",S(v({width:"28",height:"28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),{children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.286 6.445c-2.342-2.307-6.19-2.307-8.53 0l-5.353 5.272a.99.99 0 0 1-1.388-1.41l5.352-5.272c3.112-3.065 8.196-3.065 11.307 0a7.598 7.598 0 0 1 0 10.885l-7.347 7.238c-2.355 2.32-6.198 2.32-8.553 0a5.762 5.762 0 0 1 0-8.253l7.381-7.27c1.585-1.56 4.141-1.632 5.814-.167a4.06 4.06 0 0 1 .082 6.068l-6.158 5.688a.99.99 0 0 1-1.343-1.454l6.16-5.687c.93-.859.91-2.29-.044-3.127a2.315 2.315 0 0 0-3.122.088l-7.381 7.27a3.784 3.784 0 0 0 0 5.435c1.584 1.56 4.191 1.56 5.775 0l7.348-7.238a5.62 5.62 0 0 0 0-8.066Z",fill:"currentColor"})}))},ie=l.forwardRef((r,n)=>{var{label:c="Attach file",className:t,children:o}=r,i=E(r,["label","className","children"]);return e.jsxs("div",{ref:n,className:t,children:[o,e.jsxs(re,{Component:"label",before:e.jsx(oe,{}),children:[e.jsx(ne,{children:e.jsx("input",v({type:"file",placeholder:c},i))}),c]})]})}),ce=""+new URL("avatar_placeholder_black-DRyce69K.png",import.meta.url).href,de=""+new URL("avatar_placeholder_white-CbxutB7M.png",import.meta.url).href,y=[{sector:"personal",name:"photoUrl",displayName:"Avatar",editable:!0},{sector:"personal",name:"username",displayName:"Username",editable:!0},{sector:"personal",name:"email",displayName:"Email",editable:!0},{sector:"personal",name:"fullName",displayName:"Full name",editable:!0},{sector:"system",name:"id",displayName:"Inner ID",editable:!1},{sector:"system",name:"tg_id",displayName:"Telegram ID",editable:!1},{sector:"others",name:"languageCode",displayName:"Locale",editable:!1},{sector:"others",name:"role",displayName:"User Role",editable:!1}],me=[{sector:"geolocation",name:"available",displayName:"Geoposition enabled",editable:!1},{sector:"geolocation",name:"latitude",displayName:"Latitude",editable:!1},{sector:"geolocation",name:"longitude",displayName:"Longitude",editable:!1},{sector:"geolocation",name:"formattedAdress",displayName:"FormattedAddress",editable:!1},{sector:"geolocation",name:"country",displayName:"Country name",editable:!1},{sector:"geolocation",name:"city",displayName:"City name",editable:!1},{sector:"geolocation",name:"street",displayName:"Street name",editable:!1},{sector:"geolocation",name:"house",displayName:"House No",editable:!1}],xe=()=>{if(!J())return e.jsx(G,{header:"Oops",description:"Application was launched with missing init data",children:e.jsx("img",{alt:"Telegram sticker",src:"https://xelene.me/telegram.gif",style:{display:"block",width:"144px",height:"144px"}})});const n=z(),c=q(),[t,o]=l.useState(f(P)),[i,h]=l.useState(f(P)),d=f(K),C=f(V),[s,m]=l.useState(i?C:d),u=f(W),[A,D]=l.useState({...u.location,...u.address});l.useEffect(()=>{D({...u.location,...u.address})},[u]);const[_,k]=l.useState([]);if(!s)return e.jsx(Y,{children:"Something went wrong with user"});l.useEffect(()=>{n(Z(i))},[i]),l.useEffect(()=>{JSON.stringify(d)!==JSON.stringify(s)?(n($(s)),k(y.map(a=>s[a.name]!==d[a.name]?a.name:"")),h(!0)):(h(!1),k([]))},[s]),l.useEffect(()=>{i||(console.log("Sync user"),m(d))},[d]);const I=a=>{a.preventDefault(),console.log("Edit mode handler"),o(!0),t&&!i&&o(!1)},T=a=>{a.preventDefault(),console.log("Avatar change");const p=a.currentTarget.files;p&&m({...s,photoUrl:URL.createObjectURL(p[0])})},B=a=>{a.preventDefault(),console.log("Changes saved"),n(ee(s)),o(!1),h(!1)},F=a=>{a.preventDefault(),console.log("Changes canceled"),m(d),o(!1),h(!1)};return e.jsxs("div",{className:"md:container md:mx-auto pt-2",children:[i&&e.jsx("div",{className:"bg-yellow-400 text-center rounded-lg mb-1",children:"You have uncommited changes!!!"}),e.jsxs(g,{className:"flex flex-col h-full gap-2",header:e.jsxs("div",{className:"p-2 flex align-middle items-center justify-between w-full",children:[e.jsx(Q,{className:"self-start",children:"My profile"}),e.jsx(U,{mode:"plain",onClick:I,children:"Edit"})]}),footer:t&&e.jsx("div",{className:"sticky bottom-1",children:e.jsxs("div",{className:"flex flex-row justify-center items-center",children:[e.jsx(U,{className:"bg-green-400 w-full",onClick:B,children:"Confirm"}),e.jsx(U,{className:"bg-red-400 w-full",onClick:F,children:"Cancel"})]})}),children:[e.jsx(g,{header:e.jsx(b,{children:"Personal Info"}),footer:e.jsx(N,{children:"User personal information"}),children:y.map(a=>{if(a.sector==="personal")return e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),a.name==="photoUrl"&&e.jsxs(x,{after:a.editable&&t&&e.jsx(ie,{id:"input_file",onChange:T,accept:"image/png, image/jpeg"}),children:[_.includes(a.name)&&e.jsx(X,{type:"number",mode:"critical",large:!0,className:"absolute left-2 top-2 z-10",children:"Edited"}),e.jsx(te,{size:96,src:s.photoUrl?s.photoUrl:c.isDark?de:ce})]}),a.name!=="photoUrl"&&e.jsx(e.Fragment,{children:t&&a.editable?e.jsx(le,{readOnly:!(t&&a.editable),status:_.includes(a.name)?"error":"default",inputMode:"text",placeholder:a.displayName,value:s[a.name],onChange:p=>{switch(a.name){case"username":m({...s,username:p.currentTarget.value});break;case"email":m({...s,email:p.currentTarget.value});break;case"fullName":m({...s,fullName:p.currentTarget.value});break}}}):e.jsx(x,{children:s[a.name]})})]},a.name)})}),e.jsx(g,{header:e.jsx(b,{children:"System Info"}),footer:e.jsx(N,{children:"User system information"}),children:y.map(a=>{if(a.sector==="system")return e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),e.jsx(x,{children:s[a.name]})]},a.name)})}),e.jsx(g,{header:e.jsx(b,{children:"Other Info"}),footer:e.jsx(N,{children:"User other information"}),children:y.map(a=>{if(a.sector==="others")return e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),e.jsx(x,{children:s[a.name]})]},a.name)})}),e.jsx(g,{header:e.jsx(b,{children:"Geolocation Info"}),footer:e.jsx(N,{children:"User geolocation information"}),children:me.map(a=>e.jsxs("div",{children:[e.jsx(j,{level:"1",weight:"2",className:"p-6 text-[--tg-theme-hint-color]",children:a.displayName}),e.jsx(x,{children:A[a.name]})]},a.name))})]})]})};export{xe as Profile};
